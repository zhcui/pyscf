

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>7.7. Algebraic diagrammatic construction (ADC) scheme &mdash; PySCF 1.7.5 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7.8. Multi-configurational self-consistent field (MCSCF)" href="mcscf.html" />
    <link rel="prev" title="7.6. Coupled cluster (CC)" href="cc.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> PySCF
          

          
          </a>

          
            
            
              <div class="version">
                1.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. An overview of PySCF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../version.html">2. Version history</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">3. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code-rule.html">4. Code standard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmark.html">5. Benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">6. Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../theory.html">7. Theoretical methods</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="scf.html">7.1. Self-consistent field (SCF) methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="dft.html">7.2. Density functional theory (DFT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mp.html">7.3. Møller-Plesset perturbation theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="gw.html">7.4. GW method</a></li>
<li class="toctree-l2"><a class="reference internal" href="ci.html">7.5. Configuration interaction (CI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="cc.html">7.6. Coupled cluster (CC)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">7.7. Algebraic diagrammatic construction (ADC) scheme</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#background-propagator-theory">7.7.1. Background: Propagator Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#algebraic-diagrammatic-construction">7.7.2. Algebraic diagrammatic construction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#methods">7.7.3. Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mcscf.html">7.8. Multi-configurational self-consistent field (MCSCF)</a></li>
<li class="toctree-l2"><a class="reference internal" href="tddft.html">7.9. Time-dependent density functional theory (TDDFT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="rt.html">7.10. Real-time time-dependent density functional theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="eomcc.html">7.11. Equation-of-motion coupled cluster (EOM-CC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="pbc.html">7.12. Periodic boundary conditions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../advanced.html">8. Miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interface.html">9. Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">10. Main modules</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PySCF</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../theory.html">7. Theoretical methods</a> &raquo;</li>
        
      <li>7.7. Algebraic diagrammatic construction (ADC) scheme</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/theory/adc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="algebraic-diagrammatic-construction-adc-scheme">
<span id="theory-adc"></span><h1>7.7. Algebraic diagrammatic construction (ADC) scheme<a class="headerlink" href="#algebraic-diagrammatic-construction-adc-scheme" title="Permalink to this headline">¶</a></h1>
<p><em>Modules</em>: <a class="reference internal" href="../modules/adc.html#adc"><span class="std std-ref">adc</span></a></p>
<div class="section" id="background-propagator-theory">
<h2>7.7.1. Background: Propagator Theory<a class="headerlink" href="#background-propagator-theory" title="Permalink to this headline">¶</a></h2>
<p>The algebraic diagrammatic construction (ADC) theory has a close connection with the propagator theory, where the central object of interest is a propagator of the many-body system.
The general expression for a retarded propagator that describes response of a many-electron system to an external perturbation with frequency <span class="math notranslate nohighlight">\(\omega\)</span> is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}G_{\mu\nu}(\omega) &amp;= G_{\mu\nu}^{+}(\omega) \pm G_{\mu\nu}^{-}(\omega)\\
       &amp;=\langle\Psi_{0}^{N}|q_{\mu} (\omega - H + E_{0})^{-1}q_{\nu}^{\dagger}|\Psi_{0}^{N}\rangle\\
       &amp;\pm \langle\Psi_{0}^{N}|q_{\nu}^{\dagger} (\omega + H - E_{0})^{-1}q_{\mu}|\Psi_{0}^{N}\rangle,\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(G_{\mu\nu}^{+}(\omega)\)</span> and <span class="math notranslate nohighlight">\(G_{\mu\nu}^{-}(\omega)\)</span> are the forward and backward components of <span class="math notranslate nohighlight">\(G_{\mu\nu}(\omega)\)</span>,
<span class="math notranslate nohighlight">\({H}\)</span> is the electronic Hamiltonian, <span class="math notranslate nohighlight">\(|\Psi_{0}^{N}\rangle\)</span> and <span class="math notranslate nohighlight">\({E}_{0}^{N}\)</span> are the ground-state <span class="math notranslate nohighlight">\({N}\)</span>-electron wavefunction and energy, respectively.
The frequency can be expressed as <span class="math notranslate nohighlight">\(\omega \equiv \omega'\)</span> + <span class="math notranslate nohighlight">\(i\eta\)</span>, where <span class="math notranslate nohighlight">\(\omega'\)</span> is the real part of <span class="math notranslate nohighlight">\(\omega\)</span> and <span class="math notranslate nohighlight">\(i\eta\)</span> is an infinitesimal imaginary number.
Depending on the form of the operators <span class="math notranslate nohighlight">\(q_{\nu}^{\dagger}\)</span> and <span class="math notranslate nohighlight">\(q_{\mu}\)</span>, the propagator <span class="math notranslate nohighlight">\(G_{\mu\nu}(\omega)\)</span> can describe various spectroscopic processes.
Choosing <span class="math notranslate nohighlight">\(q_{\nu}^{\dagger} = a_{p}^{\dagger}a_{q} - \langle\Psi_{0}|a_{p}^{\dagger}a_{q}|\Psi_{0}\rangle\)</span>, where the operators <span class="math notranslate nohighlight">\(a_{p}\)</span> and <span class="math notranslate nohighlight">\(a_{p}^{\dagger}\)</span>
are the usual one-electron annihilation and creation operators, corresponds to a polarization propagator that provides information about electronic excitations in optical (e.g., UV/vis)
spectroscopy. Alternatively, a propagator called the one-electron Green’s Function with <span class="math notranslate nohighlight">\(q_{\nu}^{\dagger} = a_{p}^{\dagger}\)</span> describes electron attachment (EA) and ionization (IP) processes.</p>
<p>An alternative way of expressing any propagtaor is its Lehmann (or spectral) representation. As an example, the Lehmann (or spectral) representation of the one-electron Green’s Function is as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}G_{pq}(\omega) &amp;= \sum_{n}\frac{\langle\Psi_{0}^{N}|a_{p}|\Psi_{n}^{N+1}\rangle \langle\Psi_{n}^{N+1}|a_{q}^{\dagger}|\Psi_{0}^{N}\rangle}{\omega - E_{n}^{N+1}+ E_{0}^{N}}\\
               &amp;+  \sum_{n}\frac{\langle\Psi_{0}^{N}|a_{q}^{\dagger}|\Psi_{n}^{N-1}\rangle \langle\Psi_{n}^{N-1}|a_{p}|\Psi_{0}^{N}\rangle}{\omega + E_{n}^{N-1} - E_{0}^{N}}\end{split}\]</div>
<p>where the forward component corresponds to EA and the backward component to IP.
Here, the resolution of identity is carried out over all exact eigenstates <span class="math notranslate nohighlight">\(|{\Psi_{n}^{N+1}}\rangle (|{\Psi_{n}^{N-1}}\rangle)\)</span> of the electron-attached (-ionized) system
with energies <span class="math notranslate nohighlight">\(E_{n}^{N+1} (E_{n}^{N-1})\)</span>. The poles of <span class="math notranslate nohighlight">\(G_{pq}(\omega)\)</span> provide information about vertical electron attachment
<span class="math notranslate nohighlight">\((\omega_{n} = E_{n}^{N+1} - E_{0}^{N})\)</span> and ionization <span class="math notranslate nohighlight">\((\omega_{n} = E_{0}^{N} - E_{n}^{N - 1})\)</span> energies, while the residues
(e.g., <span class="math notranslate nohighlight">\(\langle\Psi_{0}^{N}|a_{p}|\Psi_{n}^{N+1}\rangle \langle\Psi_{n}^{N+1}|a_{q}^{\dagger}|\Psi_{0}^{N}\rangle\)</span>) describe probabilities of the corresponding transitions.</p>
<p>For each component of the propagator, the Lehmann representation can be compactly written in a matrix form as:</p>
<div class="math notranslate nohighlight">
\[\textbf{G}_{\pm}(\omega) = \mathbf{\tilde{X}}_{\pm}(\omega - \boldsymbol{\tilde{\Omega}}_{\pm})^{-1}\mathbf{\tilde{X}}_{\pm}^{\dagger},\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{\tilde{\Omega}}_{\pm}\)</span> are diagonal matrices of the transition energies (<span class="math notranslate nohighlight">\(\omega_{n}\)</span>) and <span class="math notranslate nohighlight">\(\mathbf{\tilde{X}}_{\pm}\)</span> are matrices of the transition amplitudes. For example, for the one-electron Green’s function, <span class="math notranslate nohighlight">\(\boldsymbol{\tilde{\Omega}}_{\pm}\)</span> correspond to vertical attachment/ionization energies, while transition amplitudes are defined as <span class="math notranslate nohighlight">\(\tilde{X}_{+pn} = \langle\Psi_{0}^{N}|a_{p}|\Psi_{n}^{N+1}\rangle\)</span> and <span class="math notranslate nohighlight">\(\tilde{X}_{-qn} = \langle\Psi_{0}^{N}|a_{q}^{\dagger}|\Psi_{n}^{N-1}\rangle\)</span>.</p>
</div>
<div class="section" id="algebraic-diagrammatic-construction">
<h2>7.7.2. Algebraic diagrammatic construction<a class="headerlink" href="#algebraic-diagrammatic-construction" title="Permalink to this headline">¶</a></h2>
<p>The propagator <span class="math notranslate nohighlight">\(\textbf{G}_{\pm}(\omega)\)</span> shown above is exact if expressed using the exact eigenstates of the system.
However, computing the exact propagator is computationally very expensive and many approximations have been introduced to reduce the computational cost.
In the ADC theory, <span class="math notranslate nohighlight">\(\textbf{G}_{\pm}(\omega)\)</span> is expressed in a basis of many-electron wavefunctions where the matrix representation of the Hamiltonian <span class="math notranslate nohighlight">\(H\)</span>
is no longer diagonal and each component of the propagator can be written as:</p>
<div class="math notranslate nohighlight">
\[\textbf{G}_{\pm}(\omega) = \textbf{T}_{\pm}(\omega\textbf{S}_{\pm}-\textbf{M}_{\pm})^{-1}\textbf{T}_{\pm}^{\dagger}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\textbf{M}_{\pm}\)</span> and <span class="math notranslate nohighlight">\(\textbf{T}_{\pm}\)</span> are called the effective Hamiltonian and transition moments matrices, respectively.
For generality, we assume that the new basis of electronic states is non-orthogonal with the overlap matrix <span class="math notranslate nohighlight">\(\textbf{S}_{\pm}\)</span>.</p>
<p>In the non-Dyson ADC methods, the propagators <span class="math notranslate nohighlight">\(\textbf{G}_{\pm}(\omega)\)</span> are evaluated by expanding the matrices <span class="math notranslate nohighlight">\(\textbf{M}\)</span>, <span class="math notranslate nohighlight">\(\textbf{S}\)</span>, and <span class="math notranslate nohighlight">\(\textbf{T}\)</span>
in a perturbative series and truncating this expansion at the <span class="math notranslate nohighlight">\(n\)</span>-th order. For example,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\textbf{M}_{\pm} &amp;\approx \textbf{M}^{(0)}_{\pm} + \textbf{M}^{(1)}_{\pm} + ...+ \textbf{M}^{(n)}_{\pm}\\\end{split}\]</div>
<p>Plugging the above equations into <span class="math notranslate nohighlight">\(\textbf{G}_{\pm}(\omega)\)</span> leads to equations of the <span class="math notranslate nohighlight">\(n\)</span>-th order ADC approximation (ADC(n)).
The ADC(n) vertical transition energies can be computed by solving the generalized eigenvalue problem:</p>
<div class="math notranslate nohighlight">
\[\textbf{M}_{\pm}\textbf{Y}_{\pm}=\textbf{S}_{\pm}\textbf{Y}_{\pm}\boldsymbol{\Omega}_{\pm}\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol\Omega_{\pm}\)</span> is a diagonal matrix of eigenvalues and <span class="math notranslate nohighlight">\(\textbf{Y}_{\pm}\)</span> is the matrix of eigenvectors that can be used to compute spectroscopic amplitudes</p>
<div class="math notranslate nohighlight">
\[\textbf{X}_{\pm}=\textbf{T}_{\pm}\textbf{S}_{\pm}^{-\frac{1}{2}}\textbf{Y}_{\pm}\]</div>
<p>which provide information about transition intensities.
Using <span class="math notranslate nohighlight">\(\boldsymbol{\Omega}_{\pm}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{X}_{\pm}\)</span> allows to compute the ADC(n) propagator and density of states</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{G}_{\pm}(\omega) &amp;= \mathbf{X}_{\pm} \left(\omega - \boldsymbol{\Omega}_{\pm}\right)^{-1}  \mathbf{X}_{\pm}^\dagger \\
A(\omega) &amp;= -\frac{1}{\pi} \mathrm{Im} \left[ \mathrm{Tr} \, \mathbf{G}_{\pm}(\omega) \right]\end{split}\]</div>
</div>
<div class="section" id="methods">
<h2>7.7.3. Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h2>
<p>At the present moment, the ADC implementation in Pyscf can be used to perform calculations of electron affinities (EA) and ionization potentials (IP) for closed- and open-shell molecules starting with the RHF, ROHF, or UHF reference SCF wavefunctions. Three ADC approximations are currently available: ADC(2), ADC(3), as well as the extended second-order approximation ADC(2)-X. The capabilities of the ADC module at present are summarized in the following table:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 28%" />
<col style="width: 32%" />
<col style="width: 22%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Method</p></td>
<td><p>Reference</p></td>
<td><p>Spin-adaptation</p></td>
<td><p>Properties</p></td>
</tr>
<tr class="row-even"><td><p>ADC(2)</p></td>
<td><p>RHF, ROHF, UHF</p></td>
<td><p>No</p></td>
<td><p>IP, EA</p></td>
</tr>
<tr class="row-odd"><td><p>ADC(2)-X</p></td>
<td><p>RHF, ROHF, UHF</p></td>
<td><p>No</p></td>
<td><p>IP, EA</p></td>
</tr>
<tr class="row-even"><td><p>ADC(3)</p></td>
<td><p>RHF, ROHF, UHF</p></td>
<td><p>No</p></td>
<td><p>IP, EA</p></td>
</tr>
</tbody>
</table>
<p>When using results of this code for publications, please cite the following paper: “Third-order algebraic diagrammatic construction theory for electron attachment and ionization energies: Conventional and Green’s function implementation”, S. Banerjee and A.Y. Sokolov, J. Chem. Phys. 151, 224112 (2019).</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mcscf.html" class="btn btn-neutral float-right" title="7.8. Multi-configurational self-consistent field (MCSCF)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cc.html" class="btn btn-neutral float-left" title="7.6. Coupled cluster (CC)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2015-2020, The PySCF Developers

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>